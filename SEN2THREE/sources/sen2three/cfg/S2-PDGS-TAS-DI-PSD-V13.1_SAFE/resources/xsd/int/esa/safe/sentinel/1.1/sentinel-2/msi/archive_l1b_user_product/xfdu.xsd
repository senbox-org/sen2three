<?xml version="1.0" encoding="UTF-8"?>

<!--
   SAFE - Standard Archive Format for Europe
   Copyright (C) 2004,2005,2006,2007,2008,2009,2010 European Space Agency (ESA)
   Copyright (C) 2004,2005,2006,2007,2008,2009,2010 GAEL Consultant
   GNU Lesser General Public License (LGPL)
   
   This file is part of SAFE
   
   SAFE is free software: you can redistribute it and/or modify
   it under the terms of the GNU Lesser General Public License as published by
   the Free Software Foundation, either version 3 of the License, or
   (at your option) any later version.
   
   SAFE is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU Lesser General Public License for more details.
   
   You should have received a copy of the GNU Lesser General Public License
   along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->


<!-- XFDU XML Schema document for SENTINEL-2 MSI Level-1b User product type.
     The container XFDU receives SAFE elements. -->

<xs:schema  xmlns:xs       ="http://www.w3.org/2001/XMLSchema"
            xmlns:sentinel-safe     ="http://www.esa.int/safe/sentinel/1.1"
            xmlns:xfdu     ="urn:ccsds:schema:xfdu:1"
            targetNamespace="urn:ccsds:schema:xfdu:1"

            elementFormDefault="unqualified"
            attributeFormDefault="unqualified">

   <xs:annotation>
      <xs:documentation>
      The container XFDU receives SAFE elements. This schema describes Manifest
      file for all SENTINEL-2 MSI Level-1B User products.
      </xs:documentation>
   </xs:annotation>

   <xs:import namespace="http://www.esa.int/safe/sentinel/1.1"
              schemaLocation="../../../safe.xsd"/>

   <xs:redefine schemaLocation="../../../xfdu.xsd">


   <!-- Restriction on the version attribute of root element XFDU -->
   <xs:simpleType name="versionType">
      <xs:annotation>
         <xs:documentation>
         Indicates the location of the XFDU XML schema validating the Manifest
         file and its version (major and minor).
         </xs:documentation>
      </xs:annotation>
      <xs:restriction base="xfdu:versionType">
         <xs:enumeration value="esa/safe/sentinel/1.1/sentinel-2/msi/archive_l1b_user_product"/>
      </xs:restriction>
   </xs:simpleType>

   <!-- ===================================================================
        SAFE METADATA SECTION
        =================================================================== -->

   <xs:complexType name="metadataSectionType">
      <xs:complexContent>
         <xs:restriction base="xfdu:metadataSectionType">
            <xs:annotation>
               <xs:documentation>
               <para>
               A container for 7 to unbounded metadata<classname>metadataObject</classname>s.
               </para>
               </xs:documentation>
            </xs:annotation>
            <xs:sequence>
               <xs:element name="metadataObject"
                           type="xfdu:metadataObjectType"
                           minOccurs="7" maxOccurs="unbounded"/>
            </xs:sequence>
         </xs:restriction>
      </xs:complexContent>
   </xs:complexType>

   <xs:complexType name="xmlDataType">
      <xs:complexContent>
         <xs:restriction base="xfdu:xmlDataType">
            <xs:annotation>
               <xs:documentation>
               A wrapper to contain XML content.
               </xs:documentation>
            </xs:annotation>
		<xs:sequence>
            <xs:choice>

               <xs:element ref="sentinel-safe:processing"
                           minOccurs="1" maxOccurs="unbounded"/>
               <xs:element ref="sentinel-safe:platform"/>
               <xs:element ref="sentinel-safe:acquisitionPeriod"/>
               <xs:element ref="sentinel-safe:frameSet"/>
               <xs:element ref="sentinel-safe:orbitReference"/>

            </xs:choice>
		</xs:sequence>
         </xs:restriction>
      </xs:complexContent>
   </xs:complexType>

   <!-- ===================================================================
        SAFE DATA SECTION
        =================================================================== -->

   <xs:complexType name="dataObjectSectionType">
      <xs:complexContent>
         <xs:restriction base="xfdu:dataObjectSectionType">
            <xs:annotation>
               <xs:documentation>
               <para>
               A container for 5 to unbounded Data Objects<classname>dataObject</classname>s.
               </para>
               </xs:documentation>
            </xs:annotation>
            <xs:sequence>

               <xs:element name="dataObject"
                           type="xfdu:dataObjectType"
                           minOccurs="5" maxOccurs="unbounded"/>

            </xs:sequence>
         </xs:restriction>
      </xs:complexContent>
   </xs:complexType>

   <xs:complexType name="dataObjectType">
      <xs:complexContent>
         <xs:restriction base="xfdu:dataObjectType">
            <xs:annotation>
               <xs:documentation>
               <para>
               The <classname>dataObject</classname> is part of a SAFE Object.
               </para>
               </xs:documentation>
            </xs:annotation>
            <xs:sequence>
               <xs:element name="byteStream"
                           type="xfdu:byteStreamType"/>
            </xs:sequence>
            <xs:attribute name="ID" use="required">
               <xs:simpleType>
                  <xs:restriction base="xs:ID">
                    <xs:pattern value="S2_Level-1[B|b]_Product_Metadata"/>
                    <xs:pattern value="INSPIRE_Metadata"/>
                    <xs:pattern value="IMG_DATA_Band_10m_[1-4]_Granule([1-9]?[0-9]{1,6})_Data"/>
                    <xs:pattern value="IMG_DATA_Band_20m_[1-6]_Granule([1-9]?[0-9]{1,6})_Data"/>
                    <xs:pattern value="IMG_DATA_Band_60m_[1-3]_Granule([1-9]?[0-9]{1,6})_Data"/>
                    <xs:pattern value="S2_Level-1[B|b]_Granule([1-9]?[0-9]{1,6})_Metadata"/>
                    <xs:pattern value="(Sensor|Geometric|General|Format)_OLQC_Report(_[1-9]?[0-9]{1,6})?_Granule([1-9]?[0-9]{1,6})_InformationData"/>
                    <xs:pattern value="CoarseCloudMask(_Band_(1|2|6)0m_[1-6])?(_[1-9]?[0-9]{1,6})?_Granule([1-9]?[0-9]{1,6})_Data"/>
                    <xs:pattern value="TechQualityMask(_Band_(1|2|6)0m_[1-6])?(_[1-9]?[0-9]{1,6})?_Granule([1-9]?[0-9]{1,6})_Data"/>
                    <xs:pattern value="DefectivePixelsMask(_Band_(1|2|6)0m_[1-6])?(_[1-9]?[0-9]{1,6})?_Granule([1-9]?[0-9]{1,6})_Data"/>
                    <xs:pattern value="SaturatedPixelsMask(_Band_(1|2|6)0m_[1-6])?(_[1-9]?[0-9]{1,6})?_Granule([1-9]?[0-9]{1,6})_Data"/>
                    <xs:pattern value="NodataPixelsMask(_Band_(1|2|6)0m_[1-6])?(_[1-9]?[0-9]{1,6})?_Granule([1-9]?[0-9]{1,6})_Data"/>
                    <xs:pattern value="PreliminaryQuickLook_Datastrip([1-9]?[0-9]{1,4})_Data"/>
                    <xs:pattern value="(Sensor|Geometric|General|Format|Radiometric)_OLQC_Report_Datastrip([1-9]?[0-9]{1,4})_InformationData"/>
                    <xs:pattern value="PreviewData"/>
                    <xs:pattern value="S2_Level-1[B|b]_Datastrip([1-9]?[0-9]{1,6})_Metadata"/>
                    <xs:pattern value="S2_GIP_[\w{Lu}_]{6}_B(00|01|02|03|04|05|06|07|08|8A|09|10|11|12)_Metadata"/>
                    <xs:pattern value="BULLETIN[A|1]_Metadata"/>
                    <xs:pattern value="Inventory_Granule([1-9]?[0-9]{1,6})_Metadata"/>
                    <xs:pattern value="Inventory_Datastrip([1-9]?[0-9]{1,4})_Metadata"/>
                    <xs:pattern value="HTML_Presentation"/>
                    <xs:pattern value="HTML_Presentation_Stylesheet"/>
			</xs:restriction>
               </xs:simpleType>
            </xs:attribute>

         </xs:restriction>
      </xs:complexContent>
   </xs:complexType>

   </xs:redefine>

</xs:schema>
